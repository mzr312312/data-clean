需求说明：
1）公司预装的正版excel2019支持的vlookup函数，搜索范围有限
2）我的搜索需求是：TableArray不是1列或连续的几列，而是分布在3个excel文件的8个sheet页中的至少30列中；
3）常规方法是把上述所有参考文件的所有内容都复制粘贴到一列中，然后用vlookup
4）此脚本可以制定参考文件集，脚本会根据数据源（1列数据）的每一项，依次遍历所有文件的所有sheet页的所有列，去一一比对；
5）找到与数据源相同的单元格，则把该单元格右侧相邻单元格的内容，填写到结果文件的“映射名称”列中，完成类似vlookup的映射列

以下是promt（模型：fitten code chat）：

定义：
1）数据源文件：C:\Users\JA085914\Desktop\PY\数据处理\电表全文映射\需要被映射的数据源.xlsx；
2）参考文件1~3：
C:\Users\JA085914\Desktop\PY\数据处理\电表全文映射\新-电池车间电表清单.xlsx；
C:\Users\JA085914\Desktop\PY\数据处理\电表全文映射\新-动力站电表清单.xlsx；
C:\Users\JA085914\Desktop\PY\数据处理\电表全文映射\新-切片车间电表清单.xlsx；
3）结果文件，为最终输出a的文件，包含2列：“数据源设备名称”和“映射名称”

需求描述：
利用python，依次读取数据源文件中，“设备名称”这一列的所有项，并且放到结果文件的“数据源设备名称”这一列中
在参考文件1~3中的所有sheet页中（需要你自己查找），依次查找数据源文件设备名称的每一项，找到某一项后，把该单元格右侧相邻单元格的内容，填写到结果文件的“映射名称”列中

第一次修改：
1）生成的结果文件，“数据源设备名称”需要从数据源文件的“设备名称”列取值，而不是“序号”列
2）生成新文件，与数据源文件相同文件夹，文件名为：“结果”+时间戳

第二次修改：
总体来说问题不大，但有一些小问题：
在参考文件1中，某一行的B、C、D这3列的内容分别位11101、11101、6300A，从数据源文件中读取的查找项为我希望你可以从左到右查找，先查找到B列的11101，然后给我返回11101。而不是你现在的，查找到了C列的11101，给我返回了D列的6300

第三次修改：
/# 检查每一列，从左到右
            for i in range(len(row)):
                if row[i] in device_names:
                    # 找到匹配的设备名称，记录映射为该列的内容
                    mapping_dict[row[i]] = row[i]  # 直接将匹配项本身记录为映射
                    break  # 找到后跳出当前行的循环
这个地方不对，像我之前说的，应该是找到匹配的设备名称之后，把该单元格右侧相邻单元格的内容，填写到结果文件的“映射名称”列中

第四次修改：
/# 检查每一列，从左到右
            for i in range(len(row)):
                if row[i] in device_names:
                    # 找到匹配的设备名称，记录映射为该列的内容
                    mapping_dict[row[i]] = row[i]  # 直接将匹配项本身记录为映射
                    break  # 找到后跳出当前行的循环
还是有问题，当前你在检查每一列的时候，我需要你遍历每一个参考文件的每一个sheet页的所有列，而不是检索完第一个匹配的列，就去检索下一个sheet页了

第5次修改：
我需要把写入数据的逻辑调整为：如果经过一次匹配，已经将某个单元格右侧相邻单元格的内容，填写到结果文件的“映射名称”列中去了，即使后续有了新的匹配项，也不会覆盖最初的填写内容

至此，脚本功能完善，可以使用